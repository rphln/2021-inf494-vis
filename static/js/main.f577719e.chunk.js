(this.webpackJsonpmoody=this.webpackJsonpmoody||[]).push([[0],{29:function(t,e,n){"use strict";n.r(e);var i=n(3),r=n.n(i),a=n(13),c=n.n(a),o=n(8),s=n.n(o),u=n(2),l=n(10),d=n(14),b=n(4),h=n(5),j=n(7),p=n(6),v=(n(20),n(1)),y=n(0),m=function(t){Object(j.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(b.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).queryInput=void 0,t.setQueryInput=function(e){var n;t.queryInput=e,null===(n=t.props.refQueryInput)||void 0===n||n.call(void 0,e)},t.appendQuery=function(e){t.queryInput&&(t.queryInput.value+=e,t.queryInput.focus())},t}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var t;null===(t=this.props.refAppendQuery)||void 0===t||t.call(void 0,this.appendQuery)}},{key:"render",value:function(){var t=this.props,e=t.onSubmit,n=t.isLoading,i=t.error,r=t.queryInputId,a=n?"is-loading":"",c=i?"is-danger":"",o=i&&Object(y.jsx)("label",{htmlFor:r,className:"help is-danger",children:i});return Object(y.jsx)("form",{onSubmit:e,children:Object(y.jsxs)("fieldset",{className:"field has-addons",children:[Object(y.jsxs)("div",{className:"control is-expanded",children:[Object(y.jsx)("input",{id:r,name:r,type:"text",placeholder:"Enter a query expression",className:"input ".concat(c),ref:this.setQueryInput}),o]}),Object(y.jsx)("div",{className:"control",children:Object(y.jsx)("button",{className:"button is-link ".concat(a),disabled:n,type:"submit",children:"Query"})})]})})}}]),n}(i.Component);m.defaultProps={queryInputId:Object(v.uniqueId)("query-dataset-form-")};var x=function(t){Object(j.a)(n,t);var e=Object(p.a)(n);function n(){return Object(b.a)(this,n),e.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var t=this.props,e=t.fields,n=t.onShortcutClick,i=t.className;return Object(y.jsx)("div",{className:"buttons has-addons is-centered ".concat(i),children:e.map((function(t){return Object(y.jsx)("button",{className:"button",onClick:n(t),children:t},t)}))})}}]),n}(i.Component),O={"":"./data/default.json","positive and toxic":"./data/positive_and_toxic.json","positive or negative":"./data/positive_or_negative.json","identity_hate and insult":"./data/identity_hate_and_insult.json","toxic or severe_toxic or obscene or threat or insult or identity_hate":"./data/any_toxicity.json",'body.str.contains("Brazil")':"./data/brazil.json"};function f(t,e){if("rphln.github.io"===window.location.hostname){var n=e.query;if(Object(v.isString)(n)&&n in O)return O[n]}var i=new URL(t,"http://127.0.0.1:8000/");return Object(v.each)(e,(function(t,e){Object(v.each)(Object(v.castArray)(t),(function(t){i.searchParams.append(e,t)}))})),i.href}function k(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(u.a)(Object(u.a)({title:t},e),{},{gridcolor:"GhostWhite",linecolor:"GhostWhite",tickcolor:"GhostWhite"})}var g=function(t){Object(j.a)(n,t);var e=Object(p.a)(n);function n(){var t;Object(b.a)(this,n);for(var i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))).setActiveTab=function(e){return t.setState({active:e})},t}return Object(h.a)(n,[{key:"render",value:function(){var t,e=this,n=(null!==(t=this.state)&&void 0!==t?t:{}).active,i=this.props,r=i.id,a=i.initial,c=i.components,o=i.minHeight,s=null!==n&&void 0!==n?n:a,u=c[s];return Object(y.jsxs)("section",{id:r,className:"section",children:[Object(y.jsx)("div",{className:"tabs is-toggle is-centered",children:Object(y.jsx)("ul",{children:Object(v.map)(Object(v.keys)(c),(function(t){return Object(y.jsx)("li",{className:s===t?"is-active":"",children:Object(y.jsx)("a",{href:"#".concat(r),role:"button",onClick:function(n){e.setActiveTab(t)},children:t})},t)}))})}),Object(y.jsx)("div",{style:{minHeight:o},children:u})]})}}]),n}(i.Component),_=n(9),C=n.n(_);function w(t){var e=t.entries,n=t.colors,i=t.layout,r=t.width,a=t.height,c=t.onPointClick,o=Object(v.map)(e,(function(t,e){return{name:e,type:"scatterternary",mode:"markers",a:Object(v.map)(t,"positive_sum"),b:Object(v.map)(t,"negative_sum"),c:Object(v.map)(t,"neutral_sum"),text:Object(v.map)(t,"subject"),hovertemplate:"<b>%{text}</b>\n    <br />Positive: %{a}\n    <br />Negative: %{b}\n    <br />Neutral: %{c}\n    <extra></extra>",marker:{color:n[e],opacity:.75,size:15}}})),s={title:"Sentiment ratios across subjects",width:r,height:a,ternary:{aaxis:k("Positive",{tickformat:",.0%"}),baxis:k("Negative",{tickformat:",.0%"}),caxis:k("Neutral",{tickformat:",.0%"})}};return Object(y.jsx)(C.a,{data:o,layout:Object(u.a)(Object(u.a)({},s),i),onClick:c})}function S(t){var e=t.entries,n=t.colors,i=t.layout,r=t.width,a=t.height,c=t.onPointClick,o={toxic_sum:"Toxic",severe_toxic_sum:"Severely toxic",obscene_sum:"Obscene",threat_sum:"Threat",insult_sum:"Insult",identity_hate_sum:"Identity hate"},s=Object(v.flatMap)(e,(function(t,e){return Object(v.map)(t,(function(t){return{type:"scatter",mode:"lines",name:t.subject,text:Object(v.map)(o,(function(e){return t.subject})),hovertemplate:"<b>%{text}</b>\n        <br />%{xaxis.title.text}: %{x}\n        <br />%{yaxis.title.text}: %{y}\n        <extra></extra>",x:Object(v.values)(o),y:Object(v.map)(Object(v.keys)(o),(function(e){return t[e]/t.body_count})),line:{color:n[e]}}}))})),l={title:"Toxicity ratios across subjects",width:r,height:a,hovermode:"closest",xaxis:k("Classification"),yaxis:k("Occurrences",{tickformat:",.0%"})};return Object(y.jsx)(C.a,{data:s,layout:Object(u.a)(Object(u.a)({},l),i),onClick:c})}function q(t){var e=t.entries,n=t.colors,i=t.layout,r=t.width,a=t.height,c=t.onPointClick,o=Object(v.map)(e,(function(t,e){return{type:"bar",name:e,text:Object(v.map)(t,"subject"),hovertemplate:"<b>%{text}</b>\n        <br />Entries: %{y}\n        <extra></extra>",x:Object(v.map)(t,"subject"),y:Object(v.map)(t,"body_count"),marker:{color:n[e]}}})),s={title:"Subject ratios across subjects",width:r,height:a,hovermode:"closest",xaxis:k("Subject"),yaxis:k("Occurrences")};return Object(y.jsx)(C.a,{data:o,layout:Object(u.a)(Object(u.a)({},s),i),onClick:c})}var I=1280,N=800,Q=function(t){Object(j.a)(n,t);var e=Object(p.a)(n);function n(t){var i;return Object(b.a)(this,n),(i=e.call(this,t)).queryInput=void 0,i.appendQuery=void 0,i.onShortcutClick=function(t){return function(e){var n;return e.preventDefault(),null===(n=i.appendQuery)||void 0===n?void 0:n.call(void 0,t)}},i.onPointClick=function(t){var e,n=Object(d.a)(t.points,1)[0].text;return null===(e=i.appendQuery)||void 0===e?void 0:e.call(void 0,'"'.concat(n,'",'))},i.handleQuerySubmit=function(t){var e;t.preventDefault(),i.setState({query:null===(e=i.queryInput)||void 0===e?void 0:e.value},(function(){i.refresh()}))},i.state={query:"",isLoading:!0,entries:{}},i}return Object(h.a)(n,[{key:"refresh",value:function(){var t=Object(l.a)(s.a.mark((function t(){var e=this;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.setState({isLoading:!0},Object(l.a)(s.a.mark((function t(){var n,i,r,a,c,o,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=f("/data/",{query:null!==(n=e.state.query)&&void 0!==n?n:""}),t.next=3,fetch(i);case 3:return r=t.sent,t.next=6,r.json();case 6:if(a=t.sent,c=a.data,o=a.detail,l={isLoading:!1},r.ok){t.next=12;break}return t.abrupt("return",e.setState(Object(u.a)(Object(u.a)({},l),{},{error:o})));case 12:e.setState(Object(u.a)(Object(u.a)({},l),{},{error:void 0,entries:Object(v.groupBy)(c,"dataset")}));case 13:case"end":return t.stop()}}),t)}))));case 1:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var t=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.refresh();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"render",value:function(){var t,e=this,i=null!==(t=this.state)&&void 0!==t?t:{},r=i.error,a=i.entries,c=i.isLoading,o={Subject:Object(y.jsx)(q,{width:I,height:N,entries:a,colors:n.colorMap,onPointClick:this.onPointClick}),Toxicity:Object(y.jsx)(S,{width:I,height:N,entries:a,colors:n.colorMap,onPointClick:this.onPointClick}),Sentiment:Object(y.jsx)(w,{width:I,height:N,entries:a,colors:n.colorMap,onPointClick:this.onPointClick})};return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)("section",{className:"section",children:Object(y.jsxs)("div",{className:"box",children:[Object(y.jsx)("div",{className:"block",children:Object(y.jsx)(m,{error:r,isLoading:c,onSubmit:this.handleQuerySubmit,refQueryInput:function(t){return e.queryInput=t},refAppendQuery:function(t){return e.appendQuery=t}})}),Object(y.jsx)(x,{fields:n.quickDialFields,onShortcutClick:this.onShortcutClick})]})}),Object(y.jsx)(g,{id:"graph",components:o,initial:"Toxicity",minHeight:N})]})}}]),n}(i.Component);Q.quickDialFields=["body","dataset","subject","sentiment","positive","negative","neutral","toxic","severe_toxic","obscene","threat","insult","identity_hate","positive or negative","positive and toxic","identity_hate and insult","toxic or severe_toxic or obscene or threat or insult or identity_hate",'body.str.contains("Brazil")'],Q.colorMap={Reddit:"#FE6100",Telegram:"#648FFF"};var P=Q;c.a.render(Object(y.jsx)(r.a.StrictMode,{children:Object(y.jsx)(P,{})}),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.f577719e.chunk.js.map